---
title: "Pima"
author: "Brian Burrows, Eric Sellew, Yonas Shiferaw, and Kelly Yang"
date: "12/3/2018"
output: html_document
---

```{r setup, include=FALSE}
library(mosaic)
library(ggplot2)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown


```{r}
pima <- read.csv("https://pmatheson.people.amherst.edu/Pima.dat", header=FALSE)
colnames(pima) <- c("PRG", "PLASMA", "BP", "THICK", "INSULIN", "BODY", "PEDIGREE", "AGE", "RESPONSE")
```

## Predict the probability that individual females have diabetes

```{r}
tally(pima$RESPONSE)
268/(500+268)
#Approximately 35% of the individual females in this sample have diabetes 
```

## EDA

```{r}
summary(pima)
histogram(~PRG, data=pima) #PRG is skewed to the right
histogram(~PLASMA, data=pima) #rather bell-shaped
histogram(~BP, data=pima) #normal, but why are there so many 0s???
histogram(~THICK, data=pima) #many zeros, and one outlier at 99, but normal otherwise
histogram(~INSULIN, data=pima) #skewed to the right
histogram(~BODY, data=pima) #kind of normal, slightly skewed to the right, many zeros
histogram(~PEDIGREE, data=pima) #skewed to the right
histogram(~AGE, data=pima) #skewed to the right
tally(~RESPONSE, data=pima) #500 no diabetes, 268 do have diabetes
```

```{r}
pima_age <- pima %>%
  filter(RESPONSE == 1) %>%
  group_by(AGE, RESPONSE) %>%
  summarize(response_total = n())
ggplot(pima_age, aes(x=AGE, y=response_total)) +
  geom_density(stat="identity")
```

```{r}
pima_bp <- pima %>%
  filter(BP > 0) %>%
  group_by(BP, RESPONSE) %>%
  summarize(response_total = n())
ggplot(pima_bp, aes(x=BP, fill=factor(RESPONSE))) +
  geom_density(alpha=0.5)
```


```{r}
pima_thick <- pima %>%
  filter(THICK > 0) %>%
  group_by(THICK, RESPONSE) %>%
  summarize(response_total = n())
ggplot(pima_thick, aes(x=THICK, fill=factor(RESPONSE))) +
  geom_density(alpha=0.5)
#looks like females with greater thickness tend to have 
```

```{r}
pima_plasma <- pima %>%
  group_by(PLASMA, RESPONSE) %>%
  summarize(response_total = n())
ggplot(pima_plasma, aes(x=PLASMA, fill=factor(RESPONSE))) +
  geom_density(alpha=0.5)
```

```{r}
pima_insulin <- pima %>%
  group_by(INSULIN, RESPONSE) %>%
  summarize(response_total = n())
ggplot(pima_insulin, aes(x=INSULIN, fill=factor(RESPONSE))) +
  geom_density(alpha=0.5)
```


```{r}
pima_body <- pima %>%
  group_by(BODY, RESPONSE) %>%
  summarize(response_total = n())
ggplot(pima_body, aes(x=BODY, fill=factor(RESPONSE))) +
  geom_density(alpha=0.5)
```

```{r}
pima_pedigree <- pima %>%
  group_by(PEDIGREE, RESPONSE) %>%
  summarize(response_total = n())
ggplot(pima_pedigree, aes(x=PEDIGREE, fill=factor(RESPONSE))) +
  geom_density(alpha=0.5)
#Pedigree may not be overly important; however, it does seem that 
```


## Plots

```{r}
ggplot(pima, aes(x=AGE, y=BP)) + geom_bar(stat="identity", position = "dodge")
```


